<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>homepage</title>
</head>

<body onload="loadUserGroups()">
    <script>
        function createMExpence() {
            window.location.href = "createMil.html"
        }
        function createRExpence() {
            window.location.href = "createRomana.html"
        }
        function createCKExpence() {
            window.location.href = "createCKE.html"
        }
        function createGroup() {
            window.location.href = "createGroup.html"
        }
        function loadUserGroups() {
            var url = "http://localhost:8080/users/" + "Antonio" + "/groups";
            var xmlhttp = new XMLHttpRequest();
            const result = fetch(url, {
                method: "GET"
            }).then(response => response.json())

                .then(groupList => {
                    var tbltop = `<table>
			    <tr><th>My Groups List:</th>`;
                    //main table content we fill from data from the rest call
                    var main = "";
                    for (i = 0; i < groupList.length; i++) {
                        main += "<tr>";
                        main += "<td>";
                        main += "<a href=\"group.html?searchbar="+groupList[i]+"\">";
                        main += groupList[i] + "</a></td>";
                        main += "</tr>"
                    }
                    var tblbottom = "</table>";
                    var tbl = tbltop + main + tblbottom;
                    document.getElementById("userGroups").innerHTML = tbl;
                });

        }
        /* function search(){
            var frm= document.forms.search;
            var groupName = frm.elements.searchbar.value;
            window.location.href = "group.html?groupName="+groupName;
        } */
    </script>
    <h1>Welcome home</h1>
    <input type="button" value="Create Romana Expence" onclick="createRExpence()">
    <input type="button" value="Create Milanese Expence" onclick="createMExpence()">
    <input type="button" value="Create a Chest&Key Expence" onclick="createCKExpence()">
    <br><br>
    <form id="search" action="group.html?groupName=" +searchbar>
        Join a Group now!
        <br>
        <input type="text" name="searchbar" id="bar">
        <input type="submit" name="searchbutton" id="srchbutton" value="Search">
        <br>or
        <input type="button" name="button" id="createButton" value="Create a New Group" onclick="createGroup()">
        <br><br><br>
        <div id="userGroups"></div>
    </form>
</body>

</html>